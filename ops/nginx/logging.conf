# Nginx JSON access log capturing upstream cache status

log_format json_cache escape=json '{"time":"$time_iso8601",'
  '"remote":"$remote_addr",'
  '"method":"$request_method",'
  '"uri":"$request_uri",'
  '"status":$status,'
  '"bytes":$bytes_sent,'
  '"req_time":$request_time,'
  '"upstream":"$upstream_addr",'
  '"upstream_status":"$upstream_status",'
  '"upstream_cache":"$upstream_cache_status",'
  '"referer":"$http_referer",'
  '"ua":"$http_user_agent"}';

access_log /var/log/nginx/wq_access.json json_cache;

